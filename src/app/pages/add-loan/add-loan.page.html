<app-header-menu 
  [activeMenu]="activeMenu"
  (menuChange)="onMenuChange($event)"
  (branchChange)="onBranchChange($event)">
  <ion-content [fullscreen]="true" class="ion-padding">
  <div class="content-container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
      <h1>Add Loan</h1>
    </div>
    
    <!-- Search Member -->
    <ion-card class="step-card">
      <ion-card-header class="step-header">
        <ion-card-title>Search Member</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="search-section">
          <div class="search-fields">
            <ion-input
              [(ngModel)]="searchFirstName"
              placeholder="First Name"
              (keypress)="onSearchKeyPress($event)"
              class="search-input">
            </ion-input>
            <ion-input
              [(ngModel)]="searchLastName"
              placeholder="Last Name"
              (keypress)="onSearchKeyPress($event)"
              class="search-input">
            </ion-input>
            <ion-input
              [(ngModel)]="searchMemberId"
              placeholder="Member ID"
              (keypress)="onSearchKeyPress($event)"
              class="search-input">
            </ion-input>
            <ion-button 
              (click)="searchMembers()" 
              [disabled]="isSearching || (!searchFirstName.trim() && !searchLastName.trim() && !searchMemberId.trim())"
              class="search-button">
              <ion-icon name="search-outline" slot="start"></ion-icon>
              Search
            </ion-button>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Member Grid -->
    <ion-card class="step-card" *ngIf="showMemberGrid && rowData.length > 0">
      <ion-card-header class="step-header">
        <ion-card-title>Recent Members ({{ rowData.length }})</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div class="grid-container">
          <ag-grid-angular
            class="ag-theme-alpine"
            style="width: 100%; height: 40vh;"
            [gridOptions]="gridOptions"
            [rowData]="rowData"
            [columnDefs]="columnDefs"
            [defaultColDef]="defaultColDef"
            [pagination]="pagination"
            [paginationPageSize]="paginationPageSize"
            [context]="gridContext"
            (gridReady)="onGridReady($event)">
          </ag-grid-angular>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Empty State -->
    <ion-card class="step-card" *ngIf="!showMemberGrid && !isSearching">
      <ion-card-content>
        <div class="empty-state">
          <ion-icon name="search-outline" size="large"></ion-icon>
          <p>Recent members will be displayed automatically, or search by First Name, Last Name, or Member ID</p>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
  </ion-content>
</app-header-menu>
