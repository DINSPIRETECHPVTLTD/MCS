<ion-header [translucent]="false">
  <ion-toolbar>
    <ion-title>{{ isEditing ? 'Edit Branch' : 'Add New Branch' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="closeModal()">
        <ion-icon name="close-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <form [formGroup]="branchForm" (ngSubmit)="onSubmit()">
    <!-- Branch Name (Required) -->
    <ion-item [class.ion-invalid]="isFieldInvalid('name')">
      <ion-label position="stacked">Branch Name <span class="required">*</span></ion-label>
      <ion-input
        formControlName="name"
        placeholder="Enter branch name"
        (ionInput)="onNameInput($event)"
        type="text"
        maxlength="100">
      </ion-input>
      <ion-note slot="error">{{ getFieldError('name') }}</ion-note>
    </ion-item>

    <!-- Branch Code -->
    

    <!-- Address -->
    <ion-item [class.ion-invalid]="isFieldInvalid('address1')">
      <ion-label position="stacked">Address 1 <span class="required">*</span></ion-label>
      <ion-input
        formControlName="address1"
        placeholder="Enter address line 1"
        type="text"
        maxlength="100"
        required>
      </ion-input>
      <ion-note slot="error">{{ getFieldError('address1') }}</ion-note>
    </ion-item>

    <ion-item [class.ion-invalid]="isFieldInvalid('address2')">
      <ion-label position="stacked">Address 2 <span class="required">*</span></ion-label>
      <ion-input
        formControlName="address2"
        placeholder="Enter address line 2"
        type="text"
        maxlength="100"
        required>
      </ion-input>
      <ion-note slot="error">{{ getFieldError('address2') }}</ion-note>
    </ion-item>

    <!-- City -->
    <ion-item [class.ion-invalid]="isFieldInvalid('city')">
      <ion-label position="stacked">City <span class="required">*</span></ion-label>
      <ion-input
        formControlName="city"
        placeholder="Enter city"
        type="text"
         maxlength="100"
         required>
      </ion-input>
      <ion-note slot="error">{{ getFieldError('city') }}</ion-note>
    </ion-item>

    <!-- State -->
    <ion-item [class.ion-invalid]="isFieldInvalid('state')">
      <ion-label position="stacked">State <span class="required">*</span></ion-label>
      <ion-select
        formControlName="state"
        placeholder="Select state"
        interface="popover">
        <ion-select-option *ngFor="let state of states" [value]="state.lookupValue">
          {{ state.lookupValue }}
        </ion-select-option>
      </ion-select>
      <ion-note slot="error">{{ getFieldError('state') }}</ion-note>
    </ion-item>

     <!-- Zip Code -->
    <ion-item [class.ion-invalid]="isFieldInvalid('zipCode')">
      <ion-label position="stacked">Zip Code <span class="required">*</span></ion-label>
      <ion-input
        formControlName="zipCode"
        placeholder="Enter zip/postal code"
        type="tel"
        inputmode="numeric"
        pattern="[0-9]*"
        maxlength="10"
        (ionInput)="onNumericInput($event, 'zipCode')"
        required>
      </ion-input>
      <ion-note slot="error">{{ getFieldError('zipCode') }}</ion-note>
    </ion-item>

    <ion-item [class.ion-invalid]="isFieldInvalid('country')">
      <ion-label position="stacked">Country <span class="required">*</span></ion-label>
      <ion-input
        formControlName="country"
        placeholder="Country"
        type="text"
        readonly
        required>
      </ion-input>
      <ion-note slot="error">{{ getFieldError('country') }}</ion-note>
    </ion-item>

    <!-- Phone -->
    <ion-item [class.ion-invalid]="isFieldInvalid('phoneNumber')">
      <ion-label position="stacked">Phone Number <span class="required">*</span></ion-label>
      <ion-input
        formControlName="phoneNumber"
        placeholder="Enter 10-digit phone number"
        type="tel"
        inputmode="numeric"
        pattern="[0-9]*"
        maxlength="10"
        (ionInput)="onNumericInput($event, 'phoneNumber')"
        required>
      </ion-input>
      <ion-note slot="error">{{ getFieldError('phoneNumber') }}</ion-note>
    </ion-item>

   
    

    <!-- Action Buttons moved to footer -->
  </form>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <div class="action-row footer-row">
      <ion-button
        type="button"
        (click)="onSubmit()"
        [disabled]="branchForm.invalid && submitted"
        class="save-button">
        <ion-icon name="checkmark-outline" slot="start"></ion-icon>
        {{ isEditing ? 'Update Branch' : 'Save Branch' }}
      </ion-button>

      <ion-button
        fill="outline"
        type="button"
        (click)="closeModal()"
        class="cancel-button">
        Cancel
      </ion-button>
    </div>
  </ion-toolbar>
</ion-footer>

